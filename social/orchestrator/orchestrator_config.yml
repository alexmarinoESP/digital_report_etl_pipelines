# Social Ads Orchestrator Configuration
#
# This file configures the unified orchestrator that coordinates all 4 platform pipelines:
# Microsoft Ads, LinkedIn Ads, Facebook Ads, and Google Ads
#
# Configuration Sections:
# 1. orchestrator: Global orchestrator settings
# 2. platforms: Individual platform configurations
# 3. parallel_groups: Groups of platforms that can run in parallel

# ============================================================================
# Orchestrator Settings
# ============================================================================
orchestrator:
  # Enable parallel execution of independent platforms
  parallel_execution: true

  # Maximum number of platforms to run in parallel
  # Set to 1 for sequential execution
  max_parallel: 2

  # Continue executing other platforms if one fails
  # If false, stops orchestrator on first failure
  continue_on_failure: true

  # Global timeout for all platforms (seconds)
  # 7200 seconds = 2 hours
  global_timeout: 7200


# ============================================================================
# Platform Configurations
# ============================================================================
platforms:
  # --------------------------------------------------------------------------
  # Microsoft Ads (BingAds SDK, CSV processing)
  # --------------------------------------------------------------------------
  - name: microsoft
    enabled: true
    priority: 1
    timeout: 1800  # 30 minutes
    retry:
      max_attempts: 2
      backoff_seconds: 60
      backoff_multiplier: 2.0
      max_backoff_seconds: 300
    dependencies: []  # No dependencies

  # --------------------------------------------------------------------------
  # LinkedIn Ads (REST API, URN handling)
  # --------------------------------------------------------------------------
  - name: linkedin
    enabled: true
    priority: 2
    timeout: 1800  # 30 minutes
    retry:
      max_attempts: 2
      backoff_seconds: 60
      backoff_multiplier: 2.0
      max_backoff_seconds: 300
    dependencies: []  # No dependencies (campaigns loaded independently)
    # Note: linkedin_ads_insights has internal dependency on linkedin_ads_campaign
    # but this is handled within the LinkedIn pipeline itself via database queries

  # --------------------------------------------------------------------------
  # Facebook Ads (Graph API SDK, nested breakdowns)
  # --------------------------------------------------------------------------
  - name: facebook
    enabled: true
    priority: 3
    timeout: 2400  # 40 minutes (larger dataset)
    retry:
      max_attempts: 2
      backoff_seconds: 90
      backoff_multiplier: 2.0
      max_backoff_seconds: 600
    dependencies: []  # No dependencies

  # --------------------------------------------------------------------------
  # Google Ads (gRPC + Protobuf, GAQL queries)
  # --------------------------------------------------------------------------
  - name: google
    enabled: true
    priority: 4
    timeout: 1800  # 30 minutes
    retry:
      max_attempts: 2
      backoff_seconds: 60
      backoff_multiplier: 2.0
      max_backoff_seconds: 300
    dependencies: []  # No dependencies


# ============================================================================
# Parallel Execution Groups
# ============================================================================
# Define groups of platforms that can safely run in parallel.
# Platforms within the same group MUST NOT have dependencies on each other.
# The orchestrator will validate these groups before execution.
#
# Example strategies:
# - Strategy 1: Group by data source independence
# - Strategy 2: Group by execution time similarity
# - Strategy 3: Balance load across groups

parallel_groups:
  # Group 1: Microsoft and Google (similar execution time, independent)
  - [microsoft, google]

  # Group 2: LinkedIn and Facebook (independent, can run after Group 1)
  - [linkedin, facebook]

# Alternative parallel strategies (comment/uncomment as needed):

# Strategy: All platforms in parallel (maximum parallelism)
# parallel_groups:
#   - [microsoft, linkedin, facebook, google]

# Strategy: Sequential execution (no parallelism)
# parallel_groups:
#   - [microsoft]
#   - [linkedin]
#   - [facebook]
#   - [google]

# Strategy: Fast platforms first, then slow platforms
# parallel_groups:
#   - [microsoft, google, linkedin]
#   - [facebook]


# ============================================================================
# Configuration Notes
# ============================================================================
#
# Priority:
# - Lower numbers = higher priority
# - Priority affects execution order within groups
# - Priority does NOT override dependencies
#
# Timeout:
# - Per-platform timeout in seconds
# - Platform execution will be interrupted if timeout exceeded
# - Set appropriate timeouts based on data volume
#
# Retry:
# - max_attempts: Total number of attempts (including initial)
# - backoff_seconds: Initial wait time before retry
# - backoff_multiplier: Exponential backoff multiplier
# - max_backoff_seconds: Maximum wait time between retries
#
# Dependencies:
# - List of platform names that must complete before this platform
# - Used for topological sorting of execution order
# - Empty list [] means no dependencies
#
# Parallel Groups:
# - Platforms in same group execute concurrently
# - Limited by max_parallel setting
# - Platforms in different groups execute sequentially
# - Groups are processed in order from top to bottom
#
# ============================================================================
# Environment Variables Required
# ============================================================================
#
# Data Sink:
# - STORAGE_TYPE: vertica | azure_table | none
# - VERTICA_HOST, VERTICA_PORT, VERTICA_DATABASE, VERTICA_USER, VERTICA_PASSWORD
# - AZURE_STORAGE_CONNECTION_STRING, AZURE_TABLE_NAME
#
# Microsoft Ads:
# - MICROSOFT_CLIENT_ID
# - MICROSOFT_CLIENT_SECRET
# - MICROSOFT_TENANT_ID
# - MICROSOFT_DEVELOPER_TOKEN
# - MICROSOFT_REFRESH_TOKEN
#
# LinkedIn Ads:
# - LINKEDIN_CLIENT_ID
# - LINKEDIN_CLIENT_SECRET
# - LINKEDIN_ACCESS_TOKEN
# - LINKEDIN_REFRESH_TOKEN
#
# Facebook Ads:
# - FACEBOOK_APP_ID
# - FACEBOOK_APP_SECRET
# - FACEBOOK_ACCESS_TOKEN
# - FACEBOOK_AD_ACCOUNT_IDS (comma-separated)
#
# Google Ads:
# - GOOGLE_CONFIG_FILE (path to google-ads.yaml)
# - GOOGLE_MANAGER_CUSTOMER_ID
#
# Optional:
# - LOG_LEVEL: DEBUG | INFO | WARNING | ERROR (default: INFO)
# - LOG_TO_FILE: true | false (default: false)
# - EXPORT_REPORT: true | false (default: true)
# - REPORT_FORMAT: json | csv (default: json)
# - REPORT_PATH: path to report file (default: execution_report.{format})
#
# ============================================================================
