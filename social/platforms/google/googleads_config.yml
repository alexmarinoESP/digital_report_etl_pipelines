# =============================================================================
# Google Ads Configuration - NEW SIMPLIFIED APPROACH
# =============================================================================
# This config uses the new SimpleGoogleProcessor with explicit column_mapping.yml
#
# Key changes:
# - use_simple_processor: true (enables new processor)
# - NO MORE: handle_columns, rename_columns, dropna_value
# - Processing is transparent via column_mapping.yml
# =============================================================================

# Placement table
google_ads_placement:
  queryget: [query_placement, query_placement_2]
  type: SearchGoogleAdsRequest
  use_simple_processor: true
  processing:
    limit_placement: true
    drop_duplicates: true
  scope: account
  day: 600
  query:
    column_name:
      - id
      - placement
  truncate: True

# Ad Creatives table
google_ads_ad_creatives:
  queryget: [query_ads_ad_creatives]
  type: SearchGoogleAdsStreamRequest
  use_simple_processor: true
  processing: {}
  scope: GoogleAdsService
  query:
    column_name:
      - ad_id
      - adgroup_id

# Campaign table
google_ads_campaign:
  queryget: [query_campaign]
  type: SearchGoogleAdsStreamRequest
  use_simple_processor: true
  processing: {}
  scope: account
  day: 150
  query:
    column_name:
      - id
  merge:
    table_name_source: google_ads_campaign_source
    fields_id:
      - id
    table_name_check:
      - google_ads_campaign
    fields_update:
      - serving_status
      - status
      - name

# Report table (loads to _source, then aggregates)
google_ads_report:
  queryget: [query_ad_report]
  type: SearchGoogleAdsStreamRequest
  use_simple_processor: true
  processing: {}
  scope: account
  day: 150
  query:
    column_name:
      - campaign_id
      - adgroup_id
      - ad_id
      - date
  merge:
    table_name_source: google_ads_report_source
    fields_id:
      - campaign_id
      - adgroup_id
      - ad_id
      - date
    table_name_check:
      - google_ads_report
    fields_update:
      - clicks
      - impressions
      - conversions
      - costmicros
      - averagecpm
      - averagecpc
      - averagecost
      - ctr

# Audience table
google_ads_audience:
  queryget: [query_audience, query_audience_2]
  type: SearchGoogleAdsRequest
  use_simple_processor: true
  processing: {}
  scope: SearchGoogleAdsRequest
  query:
    column_name:
      - id
      - display_name
  truncate: True

# Cost by Device table
google_ads_cost_by_device:
  queryget: [query_by_device, query_by_device_2]
  type: SearchGoogleAdsRequest
  use_simple_processor: true
  processing:
    aggregate_by_device: true
  scope: account
  query:
    column_name:
      - ad_id
      - device
  truncate: True

# Account table (hierarchy)
google_ads_account:
  queryget: []
  request: []
  use_simple_processor: true
  processing: {}
  scope: account
  query:
    column_name:
      - id
  truncate: True

# Violation (alert only, no DB insert)
google_ads_violation:
  queryget: [query_violation_policy]
  type: SearchGoogleAdsRequest
  use_simple_processor: true
  processing: {}
  scope: account
  avoid_insert_data: True
  send_alert:
    recipients:
      - DataScience@esprinet.com
      - angeliki.kouroupi@esprinet.com
    subject: 'Violation policy alert: Google ads'
    message: 'This email contains information regarding ads that are labelled with LIMITED_APPROVAL status belonging to campaign with status ENABLED.<br> For any additional information write to: DataScience@esprinet.com'
